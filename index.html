<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechShop - Analytics Test Ortamƒ±</title>
    
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TV6QDRPK');</script>
<!-- End Google Tag Manager -->
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .cart-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .cart-count {
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .product-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .product-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            font-weight: bold;
        }
        
        .product-title {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        .product-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 1rem;
        }
        
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .cart {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #eee;
        }
        
        .cart-total {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            margin: 1rem 0;
            color: #333;
        }
        
        .analytics-debug {
            background: rgba(0, 0, 0, 0.8);
            color: #00ff00;
            padding: 1rem;
            border-radius: 10px;
            font-family: monospace;
            margin-top: 2rem;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .debug-toggle {
            background: #333;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            margin-bottom: 1rem;
            cursor: pointer;
        }
        
        .event-filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            background: #f0f0f0;
            border: 1px solid #ddd;
            padding: 5px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn.active {
            background: #667eea;
            color: white;
        }
    </style>
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TV6QDRPK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <div class="container">
        <header class="header">
            <nav class="nav">
                <div class="logo">TechShop</div>
                <div class="cart-info">
                    <span>Sepet:</span>
                    <div class="cart-count" id="cartCount">0</div>
                    <span id="cartTotal">‚Ç∫0</span>
                </div>
            </nav>
        </header>

        <div class="products-grid">
            <div class="product-card">
                <div class="product-image">üì±</div>
                <div class="product-title">iPhone 15 Pro</div>
                <div class="product-price">‚Ç∫45,999</div>
                <button class="btn" onclick="addToCart('iphone15pro', 'iPhone 15 Pro', 45999)">Sepete Ekle</button>
            </div>

            <div class="product-card">
                <div class="product-image">üíª</div>
                <div class="product-title">MacBook Pro M3</div>
                <div class="product-price">‚Ç∫89,999</div>
                <button class="btn" onclick="addToCart('macbookprom3', 'MacBook Pro M3', 89999)">Sepete Ekle</button>
            </div>

            <div class="product-card">
                <div class="product-image">üéß</div>
                <div class="product-title">AirPods Pro</div>
                <div class="product-price">‚Ç∫8,999</div>
                <button class="btn" onclick="addToCart('airpodspro', 'AirPods Pro', 8999)">Sepete Ekle</button>
            </div>

            <div class="product-card">
                <div class="product-image">‚åö</div>
                <div class="product-title">Apple Watch Series 9</div>
                <div class="product-price">‚Ç∫15,999</div>
                <button class="btn" onclick="addToCart('applewatchs9', 'Apple Watch Series 9', 15999)">Sepete Ekle</button>
            </div>
        </div>

        <div class="cart">
            <h2>Sepetim</h2>
            <div id="cartItems"></div>
            <div class="cart-total" id="totalAmount">Toplam: ‚Ç∫0</div>
            <button class="btn" onclick="checkout()" id="checkoutBtn" style="display:none;">Satƒ±n Al</button>
        </div>

        <!-- Analytics Debug Panel -->
        <button class="debug-toggle" onclick="toggleDebug()">Analytics Debug Panel</button>
        
        <div id="debugPanel" style="display:none;">
            <div class="event-filters">
                <button class="filter-btn active" onclick="filterEvents('all')">T√ºm√º</button>
                <button class="filter-btn" onclick="filterEvents('page_view')">Sayfa G√∂r√ºnt√ºleme</button>
                <button class="filter-btn" onclick="filterEvents('add_to_cart')">Sepete Ekle</button>
                <button class="filter-btn" onclick="filterEvents('purchase')">Satƒ±n Alma</button>
                <button class="filter-btn" onclick="filterEvents('custom')">√ñzel Eventler</button>
            </div>
            <div class="analytics-debug" id="debugLog"></div>
        </div>
    </div>

    <script>
        // Global deƒüi≈ükenler
        let cart = {};
        let debugMode = false;
        let eventFilter = 'all';
        
        // DataLayer'ƒ± initialize et
        window.dataLayer = window.dataLayer || [];
        
        // Debug log fonksiyonu
        function logEvent(eventName, eventData) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${eventName}: ${JSON.stringify(eventData, null, 2)}`;
            
            if (debugMode) {
                const debugLog = document.getElementById('debugLog');
                const shouldShow = eventFilter === 'all' || 
                                 eventName.includes(eventFilter) || 
                                 (eventFilter === 'custom' && !['page_view', 'add_to_cart', 'purchase'].some(e => eventName.includes(e)));
                
                if (shouldShow) {
                    debugLog.innerHTML += logEntry + '\n\n';
                    debugLog.scrollTop = debugLog.scrollHeight;
                }
            }
        }
        
        // Sayfa y√ºkleme eventi
        function trackPageView() {
            const eventData = {
                event: 'page_view',
                page_title: document.title,
                page_location: window.location.href,
                page_path: window.location.pathname
            };
            
            // DataLayer'a g√∂nder
            dataLayer.push(eventData);
            
            // GA4'e direkt g√∂nder
            gtag('event', 'page_view', {
                page_title: document.title,
                page_location: window.location.href,
                page_path: window.location.pathname
            });
            
            logEvent('page_view', eventData);
        }
        
        // Sepete ekleme fonksiyonu
        function addToCart(itemId, itemName, price) {
            if (!cart[itemId]) {
                cart[itemId] = {
                    name: itemName,
                    price: price,
                    quantity: 0
                };
            }
            cart[itemId].quantity++;
            
            // E-commerce tracking
            const eventData = {
                event: 'add_to_cart',
                currency: 'TRY',
                value: price,
                items: [{
                    item_id: itemId,
                    item_name: itemName,
                    currency: 'TRY',
                    price: price,
                    quantity: 1
                }]
            };
            
            // DataLayer'a g√∂nder
            dataLayer.push(eventData);
            
            // GA4'e g√∂nder
            gtag('event', 'add_to_cart', {
                currency: 'TRY',
                value: price,
                items: [{
                    item_id: itemId,
                    item_name: itemName,
                    currency: 'TRY',
                    price: price,
                    quantity: 1
                }]
            });
            
            logEvent('add_to_cart', eventData);
            updateCartDisplay();
            
            // √ñzel event - √úr√ºn kategorisi tracking
            const categoryEvent = {
                event: 'product_category_interaction',
                category: getProductCategory(itemName),
                action: 'add_to_cart',
                product_name: itemName,
                product_price: price
            };
            
            dataLayer.push(categoryEvent);
            logEvent('product_category_interaction', categoryEvent);
        }
        
        // √úr√ºn kategorisini belirle
        function getProductCategory(productName) {
            if (productName.includes('iPhone')) return 'Telefon';
            if (productName.includes('MacBook')) return 'Bilgisayar';
            if (productName.includes('AirPods')) return 'Aksesuar';
            if (productName.includes('Watch')) return 'Giyilebilir';
            return 'Diƒüer';
        }
        
        // Sepet g√∂r√ºnt√ºs√ºn√º g√ºncelle
        function updateCartDisplay() {
            const cartItems = document.getElementById('cartItems');
            const cartCount = document.getElementById('cartCount');
            const cartTotal = document.getElementById('cartTotal');
            const totalAmount = document.getElementById('totalAmount');
            const checkoutBtn = document.getElementById('checkoutBtn');
            
            let itemCount = 0;
            let total = 0;
            let itemsHTML = '';
            
            for (const [id, item] of Object.entries(cart)) {
                itemCount += item.quantity;
                total += item.price * item.quantity;
                
                itemsHTML += `
                    <div class="cart-item">
                        <span>${item.name} (${item.quantity}x)</span>
                        <span>‚Ç∫${(item.price * item.quantity).toLocaleString()}</span>
                    </div>
                `;
            }
            
            cartItems.innerHTML = itemsHTML;
            cartCount.textContent = itemCount;
            cartTotal.textContent = `‚Ç∫${total.toLocaleString()}`;
            totalAmount.textContent = `Toplam: ‚Ç∫${total.toLocaleString()}`;
            
            checkoutBtn.style.display = itemCount > 0 ? 'block' : 'none';
        }
        
        // Satƒ±n alma i≈ülemi
        function checkout() {
            const total = Object.values(cart).reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const items = Object.entries(cart).map(([id, item]) => ({
                item_id: id,
                item_name: item.name,
                currency: 'TRY',
                price: item.price,
                quantity: item.quantity
            }));
            
            // Purchase event
            const purchaseEvent = {
                event: 'purchase',
                transaction_id: 'TXN_' + Date.now(),
                value: total,
                currency: 'TRY',
                items: items
            };
            
            // DataLayer'a g√∂nder
            dataLayer.push(purchaseEvent);
            
            // GA4'e g√∂nder
            gtag('event', 'purchase', {
                transaction_id: 'TXN_' + Date.now(),
                value: total,
                currency: 'TRY',
                items: items
            });
            
            logEvent('purchase', purchaseEvent);
            
            // Conversion tracking
            const conversionEvent = {
                event: 'conversion_completed',
                conversion_value: total,
                conversion_currency: 'TRY',
                conversion_items_count: Object.values(cart).reduce((sum, item) => sum + item.quantity, 0)
            };
            
            dataLayer.push(conversionEvent);
            logEvent('conversion_completed', conversionEvent);
            
            alert(`Satƒ±n alma tamamlandƒ±! Toplam: ‚Ç∫${total.toLocaleString()}`);
            
            // Sepeti temizle
            cart = {};
            updateCartDisplay();
        }
        
        // Debug panel toggle
        function toggleDebug() {
            debugMode = !debugMode;
            const debugPanel = document.getElementById('debugPanel');
            debugPanel.style.display = debugMode ? 'block' : 'none';
            
            if (debugMode) {
                logEvent('debug_mode_enabled', { timestamp: new Date().toISOString() });
            }
        }
        
        // Event filtreleme
        function filterEvents(filter) {
            eventFilter = filter;
            
            // Filter butonlarƒ±nƒ±n g√∂r√ºn√ºm√ºn√º g√ºncelle
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Debug logunu temizle ve yeniden filtrele
            document.getElementById('debugLog').innerHTML = '';
        }
        
        // Scroll tracking
        let scrollTracked = false;
        window.addEventListener('scroll', function() {
            const scrollPercent = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
            
            if (scrollPercent > 50 && !scrollTracked) {
                scrollTracked = true;
                
                const scrollEvent = {
                    event: 'scroll_depth',
                    scroll_depth: Math.round(scrollPercent),
                    page_path: window.location.pathname
                };
                
                dataLayer.push(scrollEvent);
                gtag('event', 'scroll', {
                    scroll_depth: Math.round(scrollPercent)
                });
                
                logEvent('scroll_depth', scrollEvent);
            }
        });
        
        // Sayfa √ßƒ±kƒ±≈ü tracking
        window.addEventListener('beforeunload', function() {
            const sessionData = {
                event: 'session_end',
                session_duration: Date.now() - sessionStartTime,
                cart_items_count: Object.values(cart).reduce((sum, item) => sum + item.quantity, 0),
                cart_value: Object.values(cart).reduce((sum, item) => sum + (item.price * item.quantity), 0)
            };
            
            dataLayer.push(sessionData);
            logEvent('session_end', sessionData);
        });
        
        // Session tracking
        const sessionStartTime = Date.now();
        const sessionEvent = {
            event: 'session_start',
            timestamp: new Date().toISOString(),
            user_agent: navigator.userAgent,
            screen_resolution: `${screen.width}x${screen.height}`
        };
        
        dataLayer.push(sessionEvent);
        
        // Sayfa y√ºklendikten sonra tracking ba≈ülat
        document.addEventListener('DOMContentLoaded', function() {
            trackPageView();
            logEvent('session_start', sessionEvent);
            
            // Test i√ßin otomatik event g√∂nderimi
            setTimeout(() => {
                const testEvent = {
                    event: 'test_event',
                    test_parameter: 'Analytics test ba≈üarƒ±lƒ±',
                    timestamp: new Date().toISOString()
                };
                dataLayer.push(testEvent);
                logEvent('test_event', testEvent);
            }, 2000);
        });
    </script>
</body>
</html>
