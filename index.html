<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Test - √úr√ºnler</title>
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TV6QDRPK');</script>
    <!-- End Google Tag Manager -->
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; line-height: 1.4; }
        .container { max-width: 1200px; margin: 0 auto; padding: 10px; }
        
        .header { background: #f5f5f5; padding: 10px; border: 1px solid #ddd; margin-bottom: 10px; }
        .nav { display: flex; gap: 20px; align-items: center; flex-wrap: wrap; }
        .nav a { text-decoration: none; color: #0066cc; padding: 5px 10px; border: 1px solid #0066cc; }
        .nav a:hover { background: #0066cc; color: white; }
        .nav a.active { background: #0066cc; color: white; }
        
        .breadcrumb { background: #f9f9f9; padding: 5px; margin: 10px 0; border-left: 3px solid #0066cc; }
        
        .section { border: 1px solid #ddd; margin: 10px 0; padding: 15px; background: #fafafa; }
        .section h2 { margin-bottom: 10px; color: #333; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
        .item { border: 1px solid #ccc; padding: 10px; background: white; }
        .item h3 { margin-bottom: 5px; }
        .item .price { font-weight: bold; color: #d63031; margin: 5px 0; }
        .item button { padding: 8px 12px; background: #00b894; color: white; border: none; cursor: pointer; margin: 2px; }
        .item button:hover { background: #00a085; }
        
        .cart-widget { background: #e74c3c; color: white; padding: 10px; margin-bottom: 10px; position: fixed; top: 10px; right: 10px; z-index: 1000; }
        .cart-count { font-weight: bold; font-size: 18px; }
        
        .debug-panel { position: fixed; bottom: 10px; right: 10px; width: 300px; background: black; color: lime; font-family: monospace; font-size: 12px; z-index: 1000; }
        .debug-header { background: #333; padding: 5px; cursor: pointer; }
        .debug-content { max-height: 200px; overflow-y: auto; padding: 5px; display: none; }
        .debug-content.show { display: block; }
    </style>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TV6QDRPK"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div class="container">
        <header class="header">
            <div class="nav">
                <a href="index.html">Ana Sayfa</a>
                <a href="products.html" class="active">√úr√ºnler</a>
                <a href="categories.html">Kategoriler</a>
                <a href="about.html">Hakkƒ±nda</a>
                <a href="contact.html">ƒ∞leti≈üim</a>
                <a href="blog.html">Blog</a>
                <a href="support.html">Destek</a>
            </div>
            
            <div class="breadcrumb">Ana Sayfa > √úr√ºnler</div>
        </header>

        <div class="cart-widget">
            <div class="cart-count">Sepet: <span id="cartCount">0</span></div>
            <div>Toplam: <span id="cartTotal">‚Ç∫0</span></div>
        </div>

        <main>
            <section class="section">
                <h2>T√ºm √úr√ºnler</h2>
                <div class="grid" id="allProducts">
                    <div class="item" data-category="telefon" data-price="45999" data-brand="apple">
                        <h3>iPhone 15 Pro</h3>
                        <div class="price">‚Ç∫45,999</div>
                        <div>Stok: 15 adet</div>
                        <div>Puan: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (4.8)</div>
                        <button onclick="addToCart('iphone15pro', 'iPhone 15 Pro', 45999)">Sepete Ekle</button>
                        <button onclick="viewProduct('iphone15pro')">Detay</button>
                    </div>
                    
                    <div class="item" data-category="bilgisayar" data-price="89999" data-brand="apple">
                        <h3>MacBook Pro M3</h3>
                        <div class="price">‚Ç∫89,999</div>
                        <div>Stok: 8 adet</div>
                        <div>Puan: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (4.9)</div>
                        <button onclick="addToCart('macbookprom3', 'MacBook Pro M3', 89999)">Sepete Ekle</button>
                        <button onclick="viewProduct('macbookprom3')">Detay</button>
                    </div>
                    
                    <div class="item" data-category="telefon" data-price="35999" data-brand="samsung">
                        <h3>Samsung Galaxy S24</h3>
                        <div class="price">‚Ç∫35,999</div>
                        <div>Stok: 20 adet</div>
                        <div>Puan: ‚≠ê‚≠ê‚≠ê‚≠ê (4.5)</div>
                        <button onclick="addToCart('galaxys24', 'Samsung Galaxy S24', 35999)">Sepete Ekle</button>
                        <button onclick="viewProduct('galaxys24')">Detay</button>
                    </div>
                    
                    <div class="item" data-category="telefon" data-price="12999" data-brand="xiaomi">
                        <h3>Xiaomi Redmi Note 13</h3>
                        <div class="price">‚Ç∫12,999</div>
                        <div>Stok: 35 adet</div>
                        <div>Puan: ‚≠ê‚≠ê‚≠ê‚≠ê (4.3)</div>
                        <button onclick="addToCart('redminote13', 'Xiaomi Redmi Note 13', 12999)">Sepete Ekle</button>
                        <button onclick="viewProduct('redminote13')">Detay</button>
                    </div>
                    
                    <div class="item" data-category="aksesuar" data-price="8999" data-brand="apple">
                        <h3>AirPods Pro</h3>
                        <div class="price">‚Ç∫8,999</div>
                        <div>Stok: 25 adet</div>
                        <div>Puan: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (4.7)</div>
                        <button onclick="addToCart('airpodspro', 'AirPods Pro', 8999)">Sepete Ekle</button>
                        <button onclick="viewProduct('airpodspro')">Detay</button>
                    </div>
                    
                    <div class="item" data-category="giyilebilir" data-price="15999" data-brand="apple">
                        <h3>Apple Watch Series 9</h3>
                        <div class="price">‚Ç∫15,999</div>
                        <div>Stok: 12 adet</div>
                        <div>Puan: ‚≠ê‚≠ê‚≠ê‚≠ê (4.6)</div>
                        <button onclick="addToCart('applewatchs9', 'Apple Watch Series 9', 15999)">Sepete Ekle</button>
                        <button onclick="viewProduct('applewatchs9')">Detay</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Debug Panel -->
    <div class="debug-panel">
        <div class="debug-header" onclick="toggleDebug()">
            üìä Analytics Debug [Tƒ±kla]
        </div>
        <div class="debug-content" id="debugContent">
            <div id="debugLog"></div>
        </div>
    </div>

    <script>
        // Global deƒüi≈ükenler
        let cart = JSON.parse(localStorage.getItem('cart')) || {};
        let currentPage = 'products';
        
        // DataLayer'ƒ± initialize et
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        
        // Debug fonksiyonu
        function logEvent(eventName, eventData) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${eventName}: ${JSON.stringify(eventData, null, 2)}`;
            
            const debugLog = document.getElementById('debugLog');
            debugLog.innerHTML += logEntry + '\n\n';
            debugLog.scrollTop = debugLog.scrollHeight;
            
            console.log('Analytics Event:', eventName, eventData);
        }
        
        // Sayfa y√ºklendiƒüinde
        document.addEventListener('DOMContentLoaded', function() {
            const eventData = {
                event: 'page_view',
                page_title: 'Analytics Test - √úr√ºnler',
                page_location: window.location.href,
                page_path: '/products.html'
            };
            
            dataLayer.push(eventData);
            gtag('event', 'page_view', eventData);
            logEvent('page_view', eventData);
            
            updateCartDisplay();
        });
        
        // Sepet i≈ülemleri
        function addToCart(itemId, itemName, price) {
            if (!cart[itemId]) {
                cart[itemId] = { name: itemName, price: price, quantity: 0 };
            }
            cart[itemId].quantity++;
            
            // Local storage'a kaydet
            localStorage.setItem('cart', JSON.stringify(cart));
            
            const eventData = {
                event: 'add_to_cart',
                currency: 'TRY',
                value: price,
                items: [{
                    item_id: itemId,
                    item_name: itemName,
                    currency: 'TRY',
                    price: price,
                    quantity: 1,
                    item_category: getProductCategory(itemName),
                    item_brand: getProductBrand(itemName)
                }]
            };
            
            dataLayer.push(eventData);
            gtag('event', 'add_to_cart', eventData);
            logEvent('add_to_cart', eventData);
            
            updateCartDisplay();
            showNotification(`${itemName} sepete eklendi!`);
        }
        
        function updateCartDisplay() {
            let itemCount = 0;
            let total = 0;
            
            for (const [id, item] of Object.entries(cart)) {
                itemCount += item.quantity;
                total += item.price * item.quantity;
            }
            
            document.getElementById('cartCount').textContent = itemCount;
            document.getElementById('cartTotal').textContent = `‚Ç∫${total.toLocaleString()}`;
        }
        
        function viewProduct(productId) {
            const eventData = {
                event: 'view_item',
                currency: 'TRY',
                value: getProductPrice(productId),
                items: [{
                    item_id: productId,
                    item_name: getProductName(productId),
                    currency: 'TRY',
                    price: getProductPrice(productId),
                    quantity: 1
                }]
            };
            
            dataLayer.push(eventData);
            gtag('event', 'view_item', eventData);
            logEvent('view_item', eventData);
            
            showNotification(`${getProductName(productId)} detaylarƒ± g√∂r√ºnt√ºleniyor...`);
        }
        
        // Yardƒ±mcƒ± fonksiyonlar
        function getProductCategory(productName) {
            if (productName.includes('iPhone') || productName.includes('Galaxy') || productName.includes('Redmi')) return 'telefon';
            if (productName.includes('MacBook')) return 'bilgisayar';
            if (productName.includes('AirPods')) return 'aksesuar';
            if (productName.includes('Watch')) return 'giyilebilir';
            return 'diger';
        }
        
        function getProductBrand(productName) {
            if (productName.includes('iPhone') || productName.includes('MacBook') || productName.includes('AirPods') || productName.includes('Apple')) return 'apple';
            if (productName.includes('Galaxy') || productName.includes('Samsung')) return 'samsung';
            if (productName.includes('Xiaomi') || productName.includes('Redmi')) return 'xiaomi';
            return 'diger';
        }
        
        function getProductName(productId) {
            const products = {
                'iphone15pro': 'iPhone 15 Pro',
                'macbookprom3': 'MacBook Pro M3',
                'airpodspro': 'AirPods Pro',
                'applewatchs9': 'Apple Watch Series 9',
                'galaxys24': 'Samsung Galaxy S24',
                'redminote13': 'Xiaomi Redmi Note 13'
            };
            return products[productId] || productId;
        }
        
        function getProductPrice(productId) {
            const prices = {
                'iphone15pro': 45999,
                'macbookprom3': 89999,
                'airpodspro': 8999,
                'applewatchs9': 15999,
                'galaxys24': 35999,
                'redminote13': 12999
            };
            return prices[productId] || 0;
        }
        
        function showNotification(message) {
            // Basit bildirim g√∂sterimi
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 50px; right: 20px; background: #00b894; color: white; 
                padding: 10px 20px; border-radius: 5px; z-index: 9999;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 3000);
        }
        
        function toggleDebug() {
            const content = document.getElementById('debugContent');
            content.classList.toggle('show');
        }
    </script>
</body>
</html>
